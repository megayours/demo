(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{4544:function(e,t,a){Promise.resolve().then(a.bind(a,4611))},8925:function(e,t,a){"use strict";a.d(t,{h:function(){return s}});var r=a(2642),o=a(6298);let s={getNFTs:async e=>(await e.query("pudgy.get_tokens",{account_id:e.account.id})).map(e=>({...e,blockchain:r.Y.FISHING_GAME})),getNFT:async(e,t,a,o)=>{let s=await e.query("yours.metadata",{project:t,collection:a,token_id:o});if(null!=s)return{token_id:o,metadata:s,blockchain:r.Y.FISHING_GAME}},getPudgyRods:async e=>e.query("pudgy.get_rods",{account_id:e.account.id}),equipRod:async(e,t,a)=>{await e.call((0,o.op)("pudgy.equip_fishing_rod",t,a))},unequipRod:async(e,t)=>{await e.call((0,o.op)("pudgy.unequip_fishing_rod",t))},pullFish:async(e,t)=>{await e.call((0,o.op)("pudgy.pull_fish",t))}}},1229:function(e,t,a){"use strict";a.d(t,{ContextProvider:function(){return n},T:function(){return l}});var r=a(7437),o=a(2265);let s=(0,o.createContext)({sessions:{},setSession:()=>{},logout:async()=>{}});function l(){return(0,o.useContext)(s)}function n(e){let{children:t}=e,[a,l]=(0,o.useState)({}),n=(0,o.useRef)({}),i=(0,o.useCallback)((e,t,a)=>{console.log("Setting session for blockchainRid: ".concat(e),t),l(a=>{if(void 0===t){let{[e]:t,...r}=a;return r}return{...a,[e]:t}}),t&&a?(n.current[e.toUpperCase()]=a,localStorage.setItem("session_".concat(e.toUpperCase()),"true")):(delete n.current[e.toUpperCase()],localStorage.removeItem("session_".concat(e.toUpperCase())))},[]),c=(0,o.useCallback)(async e=>{console.log("Handle logout for blockchainRid: ".concat(e));try{console.log("Logout functions available:",Object.keys(n.current));let t=n.current[e.toUpperCase()];if(t){let e=t();e instanceof Promise&&await e,console.log("Logout function executed successfully")}else console.warn("No logout function found for blockchainRid: ".concat(e));l(t=>{let{[e]:a,...r}=t;return r}),delete n.current[e.toUpperCase()],localStorage.removeItem("session_".concat(e.toUpperCase())),console.log("Session and logout function removed")}catch(e){console.error("Error during logout:",e)}},[]);return(0,o.useEffect)(()=>{console.log("Current sessions:",a),console.log("Logout functions available:",Object.keys(n.current))},[a]),(0,r.jsx)(s.Provider,{value:{sessions:a,setSession:i,logout:c},children:t})}},4611:function(e,t,a){"use strict";a.d(t,{default:function(){return g}});var r=a(7437),o=a(2265),s=a(6463),l=a(8925),n=a(2755),i=a(7138),c=a(2639),d=a(6648),u=e=>{let{rods:t,selectedRod:a,onRodClick:o}=e;return(0,r.jsx)("div",{className:"bg-[var(--color-surface)] p-4 rounded-lg shadow-lg",children:(0,r.jsx)("div",{className:"space-y-2",children:t.map(e=>{var t;let s=e.metadata.properties.Durability,l=e.metadata.properties["Equipped By"];return(0,r.jsxs)("div",{className:"flex items-center p-2 border rounded-lg cursor-pointer transition-colors ".concat(a===e.token_id?"bg-[var(--color-primary)] border-[var(--color-accent)]":"bg-[var(--color-card)] hover:bg-[var(--color-surface)]"),onClick:()=>o(e.token_id),children:[(0,r.jsx)("div",{className:"w-10 h-10 relative mr-2 flex-shrink-0",children:(0,r.jsx)(d.default,{src:null!==(t=e.metadata.image)&&void 0!==t?t:"",alt:e.metadata.name,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",style:{objectFit:"cover"},className:"rounded-md"})}),(0,r.jsxs)("div",{className:"flex-grow overflow-hidden",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-white truncate",children:e.metadata.name}),(0,r.jsxs)("div",{className:"mt-1 flex flex-wrap gap-1",children:[s&&(0,r.jsxs)("span",{className:"text-xs bg-[var(--color-surface)] text-white rounded-full px-2 py-0.5 truncate",children:["Durability: ",String(s)]}),l&&(0,r.jsxs)("span",{className:"text-xs bg-[var(--color-surface)] text-white rounded-full px-2 py-0.5 truncate",children:["Equipped By: ",String(l)]})]})]})]},e.token_id)})})})},m=e=>{var t,a;let{initialNFT:s,session:n}=e,[d,m]=(0,o.useState)(s),[h,g]=(0,o.useState)([]),[p,f]=(0,o.useState)(null),[x,v]=(0,o.useState)(!0),[y,b]=(0,o.useState)(null),N=(0,o.useRef)(null),[j,w]=(0,o.useState)({x:0,y:0}),[k,C]=(0,o.useState)(!1),[E,S]=(0,o.useState)({x:0,y:0,active:!1});(0,o.useEffect)(()=>{(async()=>{if(n)try{let e=await l.h.getPudgyRods(n),t=(await Promise.all(e.map(e=>l.h.getNFT(n,s.metadata.yours.project.name,"Pudgy Rods",e.id)))).filter(e=>void 0!==e);g(t);let a=d.metadata.properties["Fishing Rod"];if(a){let e=t.find(e=>e.metadata.name===a);e&&f(e.token_id)}}catch(e){console.error("Error fetching Fishing Rods:",e)}finally{v(!1)}})()},[n,s,d.metadata.properties]),(0,o.useEffect)(()=>{let e;let t=N.current;if(!t)return;let a=t.getContext("2d");if(!a)return;let r=()=>{a.clearRect(0,0,t.width,t.height);let o=a.createLinearGradient(0,0,0,t.height);o.addColorStop(0,"#87CEEB"),o.addColorStop(1,"#E0F6FF"),a.fillStyle=o,a.fillRect(0,0,t.width,t.height),a.fillStyle="#4FA1E2",a.fillRect(0,.6*t.height,t.width,.4*t.height),a.strokeStyle="#3D8BD9",a.lineWidth=2;for(let e=0;e<3;e++){a.beginPath(),a.moveTo(0,t.height*(.6+.05*e));for(let r=0;r<t.width;r+=20)a.lineTo(r,t.height*(.6+.05*e)+5*Math.sin(.03*r+.002*Date.now()));a.stroke()}null!==p&&(a.strokeStyle="black",a.lineWidth=2,a.beginPath(),a.moveTo(t.width,.3*t.height),a.lineTo(j.x,j.y),a.stroke()),E.active&&(a.fillStyle="rgba(255, 255, 255, 0.8)",a.beginPath(),a.arc(E.x,E.y,10,0,2*Math.PI),a.fill()),a.fillStyle="rgba(255, 0, 0, 0.5)",a.beginPath(),a.arc(j.x,j.y,10,0,2*Math.PI),a.fill(),a.strokeStyle="red",a.lineWidth=2,a.beginPath(),a.moveTo(j.x-15,j.y),a.lineTo(j.x+15,j.y),a.moveTo(j.x,j.y-15),a.lineTo(j.x,j.y+15),a.stroke(),e=requestAnimationFrame(r)};return r(),()=>{cancelAnimationFrame(e)}},[p,j,E]);let F=async()=>{try{if(!n)return;let e=await l.h.getNFT(n,d.metadata.yours.project.name,d.metadata.yours.collection,d.token_id);e&&m(e);let t=await Promise.all(h.map(e=>l.h.getNFT(n,d.metadata.yours.project.name,"Pudgy Rods",e.token_id)));g(t.filter(e=>void 0!==e))}catch(e){console.error("Error refreshing NFT metadata:",e)}},_=async e=>{try{p===e?(await l.h.unequipRod(n,d.token_id),f(null)):(await l.h.equipRod(n,d.token_id,e),f(e)),await F()}catch(e){console.error("Error equipping/unequipping rod:",e)}},T=async()=>{b(null),setTimeout(async()=>{if(Math.random()>.5){let e=["Trout","Salmon","Bass","Catfish","Tuna"],t=e[Math.floor(Math.random()*e.length)];b("You caught a ".concat(t,"!"));try{await l.h.pullFish(n,d.token_id),console.log("Successfully pulled fish on the blockchain"),await F()}catch(e){console.error("Error pulling fish:",e),b("Caught a ".concat(t,", but failed to record it. Please try again."))}}else b("No luck this time. Try again!");C(!1)},2e3)};return x?(0,r.jsx)("div",{className:"text-center",children:"Loading Fishing Rods..."}):0===h.length?(0,r.jsxs)("div",{className:"text-center p-4 bg-[var(--color-surface)] rounded-lg",children:[(0,r.jsx)("p",{className:"text-lg font-semibold mb-2",children:"You don't have any Fishing Rods!"}),(0,r.jsx)("p",{className:"mb-4",children:"Visit the Inventory to bridge your Fishing Rods and start fishing."}),(0,r.jsx)(i.default,{href:"/inventory",className:"bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition-colors",children:"Go to Inventory"})]}):(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2 order-1",children:[(0,r.jsx)("canvas",{ref:N,width:800,height:600,className:"w-full h-auto border border-gray-600 rounded cursor-none",onClick:()=>{null===p||k||(C(!0),S({x:j.x,y:j.y,active:!0}),setTimeout(()=>{S(e=>({...e,active:!1})),T()},500))},onMouseMove:e=>{let t=N.current;if(!t)return;let a=t.getBoundingClientRect();w({x:e.clientX-a.left,y:e.clientY-a.top})}}),null===p&&(0,r.jsx)("div",{className:"mt-4 p-4 bg-yellow-900 text-yellow-100 rounded-md",children:"Please equip a fishing rod to start fishing."}),y&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-green-900 text-green-100 rounded-md flex justify-between items-center",children:[(0,r.jsx)("span",{children:y}),(0,r.jsx)("button",{onClick:()=>{b(null)},className:"bg-green-700 text-white px-2 py-1 rounded hover:bg-green-600 transition-colors",children:"Dismiss"})]})]}),(0,r.jsxs)("div",{className:"md:col-span-1 order-2 flex flex-col",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(c.Z,{imageUrl:null!==(t=d.metadata.image)&&void 0!==t?t:"",tokenName:d.metadata.name,tokenDescription:null!==(a=d.metadata.description)&&void 0!==a?a:"",metadata:d.metadata,blockchain:d.blockchain,isGamePage:!0,actions:[]})}),(0,r.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,r.jsx)(u,{rods:h,selectedRod:p,onRodClick:_})})]})]})},h=a(1229);function g(){let{sessions:e}=(0,h.T)(),[t,a]=(0,o.useState)(),[i,c]=(0,o.useState)(null),[d,u]=(0,o.useState)(!0),g=(0,s.useSearchParams)();return((0,o.useEffect)(()=>{(async()=>{console.log("Fetching session"),a(e[(await (0,n.Z)()).config.blockchainRid.toUpperCase()])})()},[e]),(0,o.useEffect)(()=>{(async()=>{if(!t)return;let e=g.get("tokenId"),a=g.get("project"),r=g.get("collection");if(e&&r&&a)try{let o=await l.h.getNFT(t,a,r,parseInt(e));o&&o.metadata.yours.collection===r&&c(o)}catch(e){console.error("Error fetching NFT:",e)}finally{u(!1)}else u(!1)})()},[t,g]),d)?(0,r.jsx)("div",{className:"container mx-auto px-4 py-8 text-white",children:"Loading..."}):t?i?(0,r.jsx)("div",{className:"container mx-auto px-4 py-4 min-h-screen",children:(0,r.jsx)("div",{className:"bg-[var(--color-background)] rounded-lg shadow-md p-4 md:p-6",children:(0,r.jsx)(m,{initialNFT:i,session:t})})}):(0,r.jsx)("div",{className:"container mx-auto px-4 py-8 text-white",children:"NFT not found or not part of the Pudgy Penguin Collection."}):(0,r.jsx)("div",{className:"container mx-auto px-4 py-8 text-white",children:"Session not found."})}},2639:function(e,t,a){"use strict";var r=a(7437),o=a(6648);a(2265);var s=a(1471),l=a(2642);let n=e=>{switch(e){case l.Y.ETHEREUM:return"from-blue-500 via-blue-400 to-blue-300";case l.Y.TOKEN_CHAIN:return"from-purple-600 via-purple-500 to-purple-400";case l.Y.FISHING_GAME:return"from-green-500 via-green-400 to-green-300";default:return"from-gray-500 via-gray-400 to-gray-300"}},i=e=>{switch(e.toLowerCase()){case"fishes caught":case"fishing rod":case"equipped by":case"durability":return"bg-green-500";case"recent ".concat(l.Y.TOKEN_CHAIN," visit"):return"bg-purple-600";default:return"bg-gray-700"}};t.Z=e=>{var t,a,l,c,d;let{imageUrl:u,tokenName:m,tokenDescription:h,metadata:g,blockchain:p,isGamePage:f=!1,actions:x=[]}=e,v=f?Object.entries(g.properties).filter(e=>{let[t]=e;return["Fishes Caught","Fishing Rod"].includes(t)}):Object.entries(g.properties),y=(e,t)=>(0,r.jsxs)("div",{className:"".concat(i(e[0])," rounded-lg p-2 text-xs"),children:[(0,r.jsxs)("span",{className:"font-semibold",children:[e[0],":"]})," ","object"==typeof e[1]&&"value"in e[1]?String(e[1].value):String(e[1])]},"".concat(e[0],"-").concat(t));return(0,r.jsxs)("div",{className:"bg-[var(--color-card)] rounded-lg shadow-xl overflow-hidden transition-transform duration-300 hover:scale-105 max-w-sm mx-auto",children:[(0,r.jsx)("div",{className:"relative w-full h-64",children:(0,r.jsx)(o.default,{src:u,alt:m,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",style:{objectFit:"cover"},className:"rounded-t-lg",priority:!0})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:m}),((null===(a=g.yours)||void 0===a?void 0:null===(t=a.project)||void 0===t?void 0:t.name)||(null===(l=g.yours)||void 0===l?void 0:l.collection))&&(0,r.jsxs)("div",{className:"rounded-lg mb-4",children:[(null===(c=g.yours.project)||void 0===c?void 0:c.name)&&(0,r.jsxs)("p",{className:"text-sm text-gray-300 mb-1",children:[(0,r.jsx)("span",{className:"font-semibold text-[var(--color-secondary)]",children:"Project:"})," ",g.yours.project.name]}),(null===(d=g.yours)||void 0===d?void 0:d.collection)&&(0,r.jsxs)("p",{className:"text-sm text-gray-300",children:[(0,r.jsx)("span",{className:"font-semibold text-[var(--color-secondary)]",children:"Collection:"})," ",g.yours.collection]})]}),(0,r.jsx)("div",{className:"flex flex-col mb-3",children:(0,r.jsx)("div",{className:"inline-flex self-start bg-gradient-to-r ".concat(n(p)," text-white text-sm font-medium px-3 py-1 rounded-full"),children:p})}),(0,r.jsx)("p",{className:"text-gray-300 text-sm line-clamp-3 mb-4",children:h}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:v.map((e,t)=>y(e,t))})}),x.length>0&&(0,r.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:x.map((e,t)=>(0,r.jsx)("button",{onClick:e.onClick,className:"mega-button text-sm relative",disabled:e.loading,children:e.loading?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"opacity-0",children:e.label}),(0,r.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)(s.Z,{size:"medium"})})]}):e.label},t))})]})]})}},1471:function(e,t,a){"use strict";var r=a(7437);a(2265),t.Z=e=>{let{size:t="medium"}=e,a={small:"border-[1px]",medium:"border-2",large:"border-3"},o={small:"inset-[2px]",medium:"inset-1",large:"inset-1.5"};return(0,r.jsxs)("div",{className:"".concat({small:"h-4 w-4",medium:"h-8 w-8",large:"h-12 w-12"}[t]," relative"),children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-full animate-spin-slow ".concat(a[t]," border-transparent"),children:(0,r.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-full ".concat({small:"blur-[1px]",medium:"blur-[2px]",large:"blur-[3px]"}[t]," opacity-75")})}),(0,r.jsx)("div",{className:"absolute ".concat(o[t]," bg-[var(--color-background)] rounded-full")}),(0,r.jsx)("div",{className:"absolute ".concat(o[t]," rounded-full animate-spin ").concat(a[t]," border-transparent"),children:(0,r.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-full"})})]})}},2642:function(e,t,a){"use strict";a.d(t,{X:function(){return o},Y:function(){return r}});let r={TOKEN_CHAIN:"Token Chain",FISHING_GAME:"Fishing Game",ETHEREUM:"Ethereum"},o="0x0000000000000000000000000000000000000000000000000000000000000000"},2755:function(e,t,a){"use strict";let r;var o=a(9659);let s="08CEC3366574AE7F63CCE43A4160D9AD96510F51EBE4F59DAF16A11930B5D62E";async function l(){if(r)return r;let e={directoryNodeUrlPool:"https://node0.devnet1.chromia.dev:7740"};return s?e.blockchainRid=s:e.blockchainIid=2,r=await (0,o.eI)(e)}t.Z=l}},function(e){e.O(0,[999,208,138,595,971,23,744],function(){return e(e.s=4544)}),_N_E=e.O()}]);