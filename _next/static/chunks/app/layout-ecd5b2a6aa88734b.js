(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9325:function(e,o,t){Promise.resolve().then(t.bind(t,1229)),Promise.resolve().then(t.bind(t,9645)),Promise.resolve().then(t.t.bind(t,8877,23))},1229:function(e,o,t){"use strict";t.d(o,{ContextProvider:function(){return c},T:function(){return a}});var n=t(7437),l=t(2265),s=t(4984),i=t(8353);let r=(0,l.createContext)({sessions:{},setSession:()=>{},logout:async()=>{},isLoading:!0});function a(){return(0,l.useContext)(r)}function c(e){let{children:o}=e,[t,a]=(0,l.useState)({}),[c,u]=(0,l.useState)(!0),d=(0,l.useRef)({}),g=(0,l.useCallback)((e,o,t)=>{console.log("Setting session for blockchainRid: ".concat(e),o),a(t=>{if(void 0===o){let{[e]:o,...n}=t;return n}return{...t,[e]:o}}),o&&t?(d.current[e.toUpperCase()]=t,localStorage.setItem("session_".concat(e.toUpperCase()),"true")):(delete d.current[e.toUpperCase()],localStorage.removeItem("session_".concat(e.toUpperCase())))},[]),f=(0,l.useCallback)(async e=>{console.log("Handle logout for blockchainRid: ".concat(e));try{let o=d.current[e.toUpperCase()];if(o){let e=o();e instanceof Promise&&await e,console.log("Logout function executed successfully")}else console.warn("No logout function found for blockchainRid: ".concat(e));a(o=>{let{[e]:t,...n}=o;return n}),delete d.current[e.toUpperCase()],localStorage.removeItem("session_".concat(e.toUpperCase())),console.log("Session and logout function removed")}catch(e){console.error("Error during logout:",e)}},[]);return(0,l.useEffect)(()=>{(async()=>{u(!0);try{console.log("Attempting auto-login...");let e=await (0,i.Z)();if(localStorage.getItem("session_".concat(e.config.blockchainRid.toUpperCase()))){console.log("Found persisted session data, recreating session");let{session:o,logout:t}=await (0,s.e)(!0);o?(console.log("Session recreated successfully"),a({[e.config.blockchainRid.toUpperCase()]:o}),d.current[e.config.blockchainRid.toUpperCase()]=t):(console.log("Failed to recreate session, removing persisted data"),localStorage.removeItem("session_".concat(e.config.blockchainRid.toUpperCase())))}else{console.log("No persisted session found, creating new session");let{session:o,logout:t}=await (0,s.e)(!0);o?(console.log("New session created successfully"),a({[e.config.blockchainRid.toUpperCase()]:o}),d.current[e.config.blockchainRid.toUpperCase()]=t,localStorage.setItem("session_".concat(e.config.blockchainRid.toUpperCase()),"true")):console.log("Failed to create new session")}}catch(e){console.error("Failed to auto-login:",e)}finally{u(!1)}})()},[]),(0,l.useEffect)(()=>{console.log("Current sessions:",t),console.log("Logout functions available:",Object.keys(d.current))},[t]),(0,n.jsx)(r.Provider,{value:{sessions:t,setSession:g,logout:f,isLoading:c},children:o})}},1471:function(e,o,t){"use strict";var n=t(7437);t(2265),o.Z=e=>{let{size:o="medium"}=e,t={small:"border-[1px]",medium:"border-2",large:"border-3"},l={small:"inset-[2px]",medium:"inset-1",large:"inset-1.5"};return(0,n.jsxs)("div",{className:"".concat({small:"h-4 w-4",medium:"h-8 w-8",large:"h-12 w-12"}[o]," relative"),children:[(0,n.jsx)("div",{className:"absolute inset-0 rounded-full animate-spin-slow ".concat(t[o]," border-transparent"),children:(0,n.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-full ".concat({small:"blur-[1px]",medium:"blur-[2px]",large:"blur-[3px]"}[o]," opacity-75")})}),(0,n.jsx)("div",{className:"absolute ".concat(l[o]," bg-[var(--color-background)] rounded-full")}),(0,n.jsx)("div",{className:"absolute ".concat(l[o]," rounded-full animate-spin ").concat(t[o]," border-transparent"),children:(0,n.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-full"})})]})}},9645:function(e,o,t){"use strict";t.d(o,{default:function(){return f}});var n=t(7437),l=t(2265),s=t(7138),i=t(1229),r=t(4984),a=t(1471),c=t(8353),u=()=>{let{sessions:e,setSession:o,logout:t,isLoading:s}=(0,i.T)(),[u,d]=(0,l.useState)("loading"),g=(0,l.useRef)(!0);(0,l.useEffect)(()=>{console.log("Effect triggered - Sessions changed:",e),console.log("Effect triggered - isLoading:",s),s?d("loading"):d(Object.keys(e).length>0?"logout":"login"),console.log("Button state set to:",u)},[e,s]);let f=async()=>{if(console.log("Login button clicked"),"loading"===u)return;let e=await (0,c.Z)();d("loading");try{let{session:t,logout:n}=await (0,r.e)();t&&(console.log("New session created:",t),o(e.config.blockchainRid.toUpperCase(),t,n))}catch(e){console.error("Failed to create session:",e),d("login")}},h=(0,l.useCallback)(async()=>{if(console.log("Logout button clicked"),"loading"===u)return;let e=await (0,c.Z)();d("loading");try{console.log("Attempting to logout..."),await t(e.config.blockchainRid.toUpperCase()),console.log("Logout successful")}catch(e){console.error("Logout failed:",e),d("logout")}finally{g.current=!1}},[t,u]),m="\n    flex items-center justify-center w-32 px-4 py-2 rounded-full text-white font-semibold\n    transition-all duration-300 ease-in-out\n    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--color-accent)]\n  ",p={login:{class:"".concat(m," bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 hover:from-purple-600 hover:via-pink-600 hover:to-red-600 active:from-purple-700 active:via-pink-700 active:to-red-700"),onClick:f,content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,n.jsx)("span",{children:"Login"})]})},logout:{class:"".concat(m," bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500 hover:from-red-600 hover:via-orange-600 hover:to-yellow-600 active:from-red-700 active:via-orange-700 active:to-yellow-700"),onClick:h,content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),(0,n.jsx)("span",{children:"Logout"})]})},loading:{class:"".concat(m," bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 cursor-not-allowed"),onClick:()=>{console.log("Loading button clicked")},content:(0,n.jsx)(a.Z,{size:"medium"})}}[u];return console.log("Rendering button with state:",u),(0,n.jsx)("button",{className:p.class,onClick:()=>{console.log("Button clicked, current state:",u),p.onClick()},disabled:"loading"===u,children:p.content})},d=e=>{let{toggle:o}=e;return(0,n.jsx)("nav",{className:"w-full h-20 bg-[var(--color-surface)] sticky top-0 z-50 shadow-lg",children:(0,n.jsx)("div",{className:"container mx-auto px-4 h-full",children:(0,n.jsxs)("div",{className:"flex justify-between items-center h-full",children:[(0,n.jsx)(s.default,{href:"/",className:"flex items-center",children:(0,n.jsx)("span",{className:"text-2xl font-bold rainbow-text",children:"Mega Yours"})}),(0,n.jsx)("button",{type:"button",className:"inline-flex items-center md:hidden text-white",onClick:o,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),(0,n.jsx)("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),(0,n.jsx)("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),(0,n.jsxs)("ul",{className:"hidden md:flex gap-x-6 text-white",children:[(0,n.jsx)("li",{children:(0,n.jsx)(s.default,{href:"/",className:"nav-link",children:"Home"})}),(0,n.jsx)("li",{children:(0,n.jsx)(s.default,{href:"/inventory",className:"nav-link",children:"Inventory"})}),(0,n.jsx)("li",{children:(0,n.jsx)(s.default,{href:"/create-nft",className:"nav-link",children:"Create"})})]}),(0,n.jsx)("div",{className:"hidden md:block",children:(0,n.jsx)(u,{})})]})})})},g=e=>{let{isOpen:o,toggle:t}=e;return(0,n.jsxs)("div",{className:"fixed w-full h-full overflow-hidden justify-center bg-[var(--color-surface)] grid pt-[120px] left-0 z-50 transition-all duration-300 ".concat(o?"top-0 opacity-100":"-top-full opacity-0"),children:[(0,n.jsx)("button",{className:"absolute right-0 p-5 text-white",onClick:t,children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),(0,n.jsxs)("ul",{className:"text-center leading-relaxed text-xl",children:[(0,n.jsx)("li",{className:"py-2",children:(0,n.jsx)(s.default,{href:"/",onClick:t,className:"nav-link",children:"Home"})}),(0,n.jsx)("li",{className:"py-2",children:(0,n.jsx)(s.default,{href:"/inventory",onClick:t,className:"nav-link",children:"Inventory"})}),(0,n.jsx)("li",{className:"py-2",children:(0,n.jsx)(s.default,{href:"/create-nft",onClick:t,className:"nav-link",children:"Create NFT"})})]})]})},f=()=>{let[e,o]=(0,l.useState)(!1),t=()=>{o(!e)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g,{isOpen:e,toggle:t}),(0,n.jsx)(d,{toggle:t})]})}},4984:function(e,o,t){"use strict";t.d(o,{e:function(){return s}});var n=t(8037),l=t(8353);async function s(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!window.ethereum)return console.error("Ethereum not found on window"),{session:void 0,logout:()=>{}};let o=await (0,l.Z)(),t=await (0,n.nxA)(window.ethereum),s=(0,n._zT)(o,t),i=await s.getAccounts(),r=(0,n.U7w)();if(i.length>0){let o=i[0].id;if(e){let e=await r.getKeyStore(o);if(!(null==e?void 0:e.pubKey))return{session:void 0,logout:()=>{}};{let{session:e,logout:t}=await s.login({accountId:o,loginKeyStore:r,config:{rules:(0,n.mm6)((0,n.i4F)(2)),flags:["MySession"]}});return{session:e,logout:()=>{t(),console.log("Logging out...")}}}}let{session:t,logout:l}=await s.login({accountId:o,loginKeyStore:r,config:{rules:(0,n.mm6)((0,n.i4F)(2)),flags:["MySession"]}});return{session:t,logout:()=>{l(),console.log("Logging out...")}}}if(!e){let e=(0,n.Wh)(["A","T"],t.id),{session:l,logout:s}=await (0,n.UDE)(o,t,n.SCz.open(e,{config:{rules:(0,n.mm6)((0,n.i4F)(2)),flags:["MySession"]}}));return{session:l,logout:()=>{s(),console.log("Logging out...")}}}return{session:void 0,logout:()=>{}}}},8353:function(e,o,t){"use strict";let n;var l=t(9659),s=t(357);let i=s.env.NEXT_PUBLIC_D1_NODE_URL_POOL||"http://localhost:7740",r=s.env.NEXT_PUBLIC_MEGA_CHAIN_BLOCKCHAIN_RID;async function a(){if(n)return n;let e={directoryNodeUrlPool:i};return r?e.blockchainRid=r:e.blockchainIid=1,n=await (0,l.eI)(e)}o.Z=a},8877:function(){}},function(e){e.O(0,[404,999,233,138,971,23,744],function(){return e(e.s=9325)}),_N_E=e.O()}]);