(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{4451:function(e,t,a){Promise.resolve().then(a.bind(a,2291))},8925:function(e,t,a){"use strict";a.d(t,{h:function(){return i}});var o=a(2642),n=a(8037);let i={getNFTs:async e=>(await e.query("pudgy.get_tokens",{account_id:e.account.id})).map(e=>({...e,blockchain:o.Y.FISHING_GAME})),getNFT:async(e,t,a,n)=>{let i=await e.query("yours.metadata",{project:t,collection:a,token_id:n});if(console.log("Metadata: ".concat(i)),null!=i)return{token_id:n,metadata:i,blockchain:o.Y.FISHING_GAME}},getPudgyRods:async e=>e.query("pudgy.get_rods",{account_id:e.account.id}),equipRod:async(e,t,a)=>{await e.call((0,n.op)("pudgy.equip_fishing_rod",t,a))},unequipRod:async(e,t)=>{await e.call((0,n.op)("pudgy.unequip_fishing_rod",t))},pullFish:async(e,t)=>{await e.call((0,n.op)("pudgy.pull_fish",t))}}},1229:function(e,t,a){"use strict";a.d(t,{ContextProvider:function(){return c},T:function(){return r}});var o=a(7437),n=a(2265);let i=(0,n.createContext)({sessions:{},setSession:()=>{},logout:async()=>{}});function r(){return(0,n.useContext)(i)}function c(e){let{children:t}=e,[a,r]=(0,n.useState)({}),c=(0,n.useRef)({}),l=(0,n.useCallback)((e,t,a)=>{console.log("Setting session for blockchainRid: ".concat(e),t),r(a=>{if(void 0===t){let{[e]:t,...o}=a;return o}return{...a,[e]:t}}),t&&a?(c.current[e.toUpperCase()]=a,localStorage.setItem("session_".concat(e.toUpperCase()),"true")):(delete c.current[e.toUpperCase()],localStorage.removeItem("session_".concat(e.toUpperCase())))},[]),s=(0,n.useCallback)(async e=>{console.log("Handle logout for blockchainRid: ".concat(e));try{let t=c.current[e.toUpperCase()];if(t){let e=t();e instanceof Promise&&await e,console.log("Logout function executed successfully")}else console.warn("No logout function found for blockchainRid: ".concat(e));r(t=>{let{[e]:a,...o}=t;return o}),delete c.current[e.toUpperCase()],localStorage.removeItem("session_".concat(e.toUpperCase())),console.log("Session and logout function removed")}catch(e){console.error("Error during logout:",e)}},[]);return(0,n.useEffect)(()=>{console.log("Current sessions:",a),console.log("Logout functions available:",Object.keys(c.current))},[a]),(0,o.jsx)(i.Provider,{value:{sessions:a,setSession:l,logout:s},children:t})}},2639:function(e,t,a){"use strict";var o=a(7437),n=a(6648);a(2265);var i=a(1471),r=a(2642);let c=e=>{switch(e){case r.Y.ETHEREUM:return"from-blue-500 via-blue-400 to-blue-300";case r.Y.TOKEN_CHAIN:return"from-purple-600 via-purple-500 to-purple-400";case r.Y.FISHING_GAME:return"from-green-500 via-green-400 to-green-300";default:return"from-gray-500 via-gray-400 to-gray-300"}},l=e=>{switch(e.toLowerCase()){case"fishes caught":case"fishing rod":case"equipped by":case"durability":return"bg-green-500";case"recent ".concat(r.Y.TOKEN_CHAIN," visit"):return"bg-purple-600";default:return"bg-gray-700"}};t.Z=e=>{let{imageUrl:t,tokenName:a,tokenDescription:r,metadata:s,blockchain:d,isGamePage:u=!1,actions:m=[]}=e,p=u?Object.entries(s.properties).filter(e=>{let[t]=e;return["Fishes Caught","Fishing Rod"].includes(t)}):Object.entries(s.properties),g=(e,t)=>(0,o.jsxs)("div",{className:"".concat(l(e[0])," rounded-lg p-2 text-xs"),children:[(0,o.jsxs)("span",{className:"font-semibold",children:[e[0],":"]})," ","object"==typeof e[1]&&"value"in e[1]?String(e[1].value):String(e[1])]},"".concat(e[0],"-").concat(t));return(0,o.jsxs)("div",{className:"bg-[var(--color-card)] rounded-lg shadow-xl overflow-hidden transition-transform duration-300 hover:scale-105 max-w-sm mx-auto",children:[(0,o.jsx)("div",{className:"relative w-full h-64",children:(0,o.jsx)(n.default,{src:t,alt:a,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",style:{objectFit:"cover"},className:"rounded-t-lg",priority:!0})}),(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:a}),(0,o.jsxs)("div",{className:"items-center gap-2 mb-3",children:[(0,o.jsx)("p",{className:"text-sm font-semibold text-gray-200 whitespace-nowrap",children:"Token & Metadata Source"}),(0,o.jsx)("div",{className:"inline-flex bg-gradient-to-r ".concat(c(d)," text-white text-sm font-medium px-3 py-1 rounded-full mt-2"),children:d})]}),(0,o.jsx)("p",{className:"text-gray-300 text-sm line-clamp-3 mb-4",children:r}),(0,o.jsx)("div",{className:"mb-4",children:(0,o.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:p.map((e,t)=>g(e,t))})}),m.length>0&&(0,o.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:m.map((e,t)=>(0,o.jsx)("button",{onClick:e.onClick,className:"mega-button text-sm relative",disabled:e.loading,children:e.loading?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"opacity-0",children:e.label}),(0,o.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,o.jsx)(i.Z,{size:"medium"})})]}):e.label},t))})]})]})}},1471:function(e,t,a){"use strict";var o=a(7437);a(2265),t.Z=e=>{let{size:t="medium"}=e,a={small:"border-[1px]",medium:"border-2",large:"border-3"},n={small:"inset-[2px]",medium:"inset-1",large:"inset-1.5"};return(0,o.jsxs)("div",{className:"".concat({small:"h-4 w-4",medium:"h-8 w-8",large:"h-12 w-12"}[t]," relative"),children:[(0,o.jsx)("div",{className:"absolute inset-0 rounded-full animate-spin-slow ".concat(a[t]," border-transparent"),children:(0,o.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-full ".concat({small:"blur-[1px]",medium:"blur-[2px]",large:"blur-[3px]"}[t]," opacity-75")})}),(0,o.jsx)("div",{className:"absolute ".concat(n[t]," bg-[var(--color-background)] rounded-full")}),(0,o.jsx)("div",{className:"absolute ".concat(n[t]," rounded-full animate-spin ").concat(a[t]," border-transparent"),children:(0,o.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-full"})})]})}},2291:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var o=a(7437),n=a(2265),i=a(6463),r=a(2639),c=a(1471),l=a(2642);function s(e){var t,a,o;console.log("Serializing metadata: ".concat(JSON.stringify(e)));let n=[e.yours.modules,e.yours.project,e.yours.collection];return[e.name,JSON.stringify(e.properties),n,null!==(t=e.description)&&void 0!==t?t:null,null!==(a=e.image)&&void 0!==a?a:null,null!==(o=e.animation_url)&&void 0!==o?o:null]}function d(e,t,a){return{name:e.name,properties:Object.fromEntries(e.attributes.map(e=>[e.trait_type,e.value])),yours:{modules:[],project:t,collection:a},description:e.description,image:e.image,animation_url:e.animation_url}}var u=a(8037);let m={getNFT:async(e,t,a,o)=>{let n=await e.query("yours.metadata",{project:t,collection:a,token_id:o});return{token_id:o,metadata:n,blockchain:l.Y.TOKEN_CHAIN}},getNFTs:async e=>(await e.query("importer.get_tokens",{account_id:e.account.id})).map(e=>({...e,blockchain:l.Y.TOKEN_CHAIN})),importNFT:async(e,t,a)=>{"Pudgy Rods"===a.yours.collection?await e.call((0,u.op)("importer.import_token",s(a),l.Y.ETHEREUM,"0xROD",t)):await e.call((0,u.op)("importer.import_token",s(a),l.Y.ETHEREUM,"0xPUDGY",t))}},p={getGatewayUrl:e=>{let t="ipfs://";if(e.startsWith(t)){let a=e.slice(t.length);return"https://ipfs.io/ipfs/".concat(a)}return e},fetchNFTMetadata:async e=>{let t=await fetch(p.getGatewayUrl(e)),a=await t.json();return{image:p.getGatewayUrl(a.image),name:a.name,description:a.description,attributes:a.attributes}}},g="TheIglooCompany",h=[8109,8110,8111,8112,8113,8114],f=[1447,8400,706,8225,3525,6610],y={getNFTs:async()=>[...await Promise.all(h.map(async e=>{let t=await p.fetchNFTMetadata("".concat("ipfs://bafybeibc5sgo2plmjkq2tzmhrn54bk3crhnc23zd2msg4ea7a4pxrkgfna","/").concat(e));return{token_id:e,metadata:d(t,g,"Pudgy Penguins"),blockchain:l.Y.ETHEREUM}})),...await Promise.all(f.map(async e=>{let t=await p.fetchNFTMetadata("".concat("https://api.pudgypenguins.io/present","/").concat(e));return{token_id:e,metadata:d({...t,attributes:[t.attributes]},g,"Pudgy Rods"),blockchain:l.Y.ETHEREUM}}))]};var N=a(1229);async function b(e,t,a,o,n){if(!e)return;let i=await e.query("yours.metadata",{project:t,collection:a,token_id:o});return console.log("Metadata: ".concat(JSON.stringify(i))),new Promise(async(t,a)=>{try{await e.transactionBuilder().add((0,u.op)("yours.init_transfer",n.account.id,i.yours.project,i.yours.collection,o,1,s(i)),{onAnchoredHandler:async a=>{if(!a)throw Error("No data provided after init_transfer");let o=await a.createProof(n.blockchainRid);await n.transactionBuilder().add(o,{authenticator:u.wSQ}).add((0,u.op)("yours.apply_transfer",a.tx,a.opIndex),{authenticator:u.wSQ,onAnchoredHandler:async t=>{if(!t)throw Error("No data provided after apply_transfer");let a=await t.createProof(e.blockchainRid);await e.transactionBuilder().add(a,{authenticator:u.wSQ}).add((0,u.op)("yours.complete_transfer",t.tx,t.opIndex),{authenticator:u.wSQ}).buildAndSend()}}).buildAndSendWithAnchoring(),t()}}).buildAndSendWithAnchoring()}catch(e){a(e)}})}var x=a(8925),k=a(2755),_=e=>{let{isOpen:t,onClose:a,children:n}=e;return t?(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,o.jsxs)("div",{className:"modal-content bg-gradient-to-br from-[var(--color-surface)] to-[var(--color-background)] rounded-lg p-6 max-w-sm w-full shadow-xl",children:[(0,o.jsx)("div",{className:"flex justify-end",children:(0,o.jsx)("button",{onClick:a,className:"text-[var(--color-text)] hover:text-[var(--color-primary)] transition-colors duration-300",children:"\xd7"})}),n]})}):null},E=a(2523),v=function(){let[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)(!0),[d,u]=(0,n.useState)({}),{sessions:p}=(0,N.T)(),[g,h]=(0,n.useState)(),[f,v]=(0,n.useState)(),w=(0,i.useRouter)(),[j,I]=(0,n.useState)(null),[T,C]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{h(p[(await (0,E.Z)()).config.blockchainRid.toUpperCase()]),v(p[(await (0,k.Z)()).config.blockchainRid.toUpperCase()])})()},[p]),(0,n.useEffect)(()=>{g&&f&&F()},[g,f]);let F=(0,n.useCallback)(async()=>{s(!0);try{let e=g?await m.getNFTs(g):[],a=f?await x.h.getNFTs(f):[],o=await y.getNFTs(),n=await Promise.all(o.map(async e=>{let t=await m.getNFT(g,e.metadata.yours.project,e.metadata.yours.collection,e.token_id),a=await x.h.getNFT(f,e.metadata.yours.project,e.metadata.yours.collection,e.token_id);return null==t||null==a?e:null}));t([...e,...a,...n.filter(e=>null!==e)])}catch(e){console.error("Error refreshing NFTs:",e)}finally{s(!1)}},[g,f]),H=(e,t)=>e.metadata.yours.project===t.metadata.yours.project&&e.metadata.yours.collection===t.metadata.yours.collection&&e.token_id===t.token_id,S=(0,n.useCallback)((e,a,o)=>{console.log("updatedNFT: ".concat(JSON.stringify(e))),t(t=>{let n=t.map(t=>H(t,e)&&t.blockchain===a?(console.log("Updating NFT from",a,"to",o),{...e,blockchain:o}):t);return n.some(t=>H(t,e)&&t.blockchain===o)||n.push({...e,blockchain:o}),n})},[]),A=(e,t,a)=>{u(o=>({...o,["".concat(e,"-").concat(t)]:a}))},Y=async(e,t)=>{A(e.token_id,"bridge",!0);try{if(e.blockchain===l.Y.ETHEREUM&&t===l.Y.TOKEN_CHAIN){await m.importNFT(g,e.token_id,e.metadata);let t=await m.getNFT(g,e.metadata.yours.project,e.metadata.yours.collection,e.token_id);t&&S({...t,blockchain:l.Y.ETHEREUM},l.Y.ETHEREUM,l.Y.TOKEN_CHAIN)}else if(e.blockchain===l.Y.TOKEN_CHAIN&&t===l.Y.FISHING_GAME){await b(g,e.metadata.yours.project,e.metadata.yours.collection,e.token_id,f);let t=await x.h.getNFT(f,e.metadata.yours.project,e.metadata.yours.collection,e.token_id);console.log("Bridged NFT: ".concat(null==t?void 0:t.token_id,"@").concat(null==t?void 0:t.blockchain)),t&&S({...t,blockchain:l.Y.TOKEN_CHAIN},l.Y.TOKEN_CHAIN,l.Y.FISHING_GAME)}else if(e.blockchain===l.Y.FISHING_GAME&&t===l.Y.TOKEN_CHAIN){await b(f,e.metadata.yours.project,e.metadata.yours.collection,e.token_id,g);let t=await m.getNFT(g,e.metadata.yours.project,e.metadata.yours.collection,e.token_id);console.log("Bridged back NFT: ".concat(JSON.stringify(t))),t&&S({...t,blockchain:l.Y.FISHING_GAME},l.Y.FISHING_GAME,l.Y.TOKEN_CHAIN)}}catch(e){console.error("Error bridging token:",e)}finally{A(e.token_id,"bridge",!1)}},O=e=>{w.push("/game?project=".concat(e.metadata.yours.project,"&collection=").concat(e.metadata.yours.collection,"&tokenId=").concat(e.token_id))},G=e=>{console.log("Handling bridge for ".concat(JSON.stringify(e))),I(e),C(!0)},M=()=>{C(!1),I(null)},R=async e=>{j&&(M(),console.log("Executing bridge to ".concat(e," for ").concat(JSON.stringify(j))),await Y(j,e))},U=e=>{let t=[];return t.push({label:"Bridge",onClick:()=>G(e),loading:d["".concat(e.token_id,"-bridge")]||!1}),e.blockchain===l.Y.FISHING_GAME&&"Pudgy Penguins"===e.metadata.yours.collection&&t.push({label:"Play",onClick:()=>O(e),loading:!1}),t};return g&&f?a?(0,o.jsx)("div",{className:"container mx-auto px-4 py-8 flex justify-center items-center h-screen",children:(0,o.jsx)(c.Z,{size:"large"})}):(0,o.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,o.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Your NFT Inventory"}),(0,o.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,o.jsx)(r.Z,{imageUrl:e.metadata.image||"",tokenName:e.metadata.name,tokenDescription:e.metadata.description||"",metadata:e.metadata,actions:U(e),blockchain:e.blockchain},"".concat(e.token_id,"-").concat(e.blockchain)))},e.map(e=>"".concat(e.token_id,"-").concat(e.blockchain)).join(",")),(0,o.jsx)(_,{isOpen:T,onClose:M,children:j&&(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Select a target blockchain"}),(0,o.jsx)("div",{className:"space-y-2",children:[l.Y.TOKEN_CHAIN,l.Y.FISHING_GAME].map(e=>(0,o.jsx)("button",{className:"w-full py-2 px-4 rounded transition-all duration-200 ".concat(j.blockchain===l.Y.ETHEREUM&&e!==l.Y.TOKEN_CHAIN||j.blockchain===l.Y.TOKEN_CHAIN&&e!==l.Y.FISHING_GAME||j.blockchain===l.Y.FISHING_GAME&&e!==l.Y.TOKEN_CHAIN?"bg-gray-300 text-gray-500 cursor-not-allowed opacity-50":"bg-blue-500 text-white hover:bg-blue-600"),onClick:()=>R(e),disabled:j.blockchain===l.Y.ETHEREUM&&e!==l.Y.TOKEN_CHAIN||j.blockchain===l.Y.TOKEN_CHAIN&&e!==l.Y.FISHING_GAME||j.blockchain===l.Y.FISHING_GAME&&e!==l.Y.TOKEN_CHAIN,children:e},e))})]})})]}):(0,o.jsx)("div",{className:"container mx-auto px-4 py-8 flex justify-center items-center h-screen",children:(0,o.jsxs)("p",{children:["Please connect to ",l.Y.TOKEN_CHAIN," and ",l.Y.FISHING_GAME," to view your inventory."]})})}},2642:function(e,t,a){"use strict";a.d(t,{Y:function(){return o}});let o={TOKEN_CHAIN:"Token Chain",FISHING_GAME:"Fishing Game",ETHEREUM:"Ethereum"}},2755:function(e,t,a){"use strict";let o;var n=a(9659);let i="5B3DAF8CC857074B61DE6D52E5B5D9E37F99412E008243681B5859C30DFE21EB";async function r(){if(o)return o;let e={directoryNodeUrlPool:"https://node0.devnet1.chromia.dev:7740"};return i?e.blockchainRid=i:e.blockchainIid=2,o=await (0,n.eI)(e)}t.Z=r},2523:function(e,t,a){"use strict";let o;var n=a(9659);let i="https://node0.devnet1.chromia.dev:7740",r="DEB3B1D821B9585DBFF7A7D98A42C0D61271DA114392F25241D0EBD767D27A86";async function c(){if(console.log("Getting Mega Yours Chromia Client"),console.log("NODE_URL_POOL",i),console.log("BLOCKCHAIN_RID",r),o)return o;let e={directoryNodeUrlPool:i};return r?e.blockchainRid=r:e.blockchainIid=1,o=await (0,n.eI)(e)}t.Z=c}},function(e){e.O(0,[999,233,595,971,23,744],function(){return e(e.s=4451)}),_N_E=e.O()}]);