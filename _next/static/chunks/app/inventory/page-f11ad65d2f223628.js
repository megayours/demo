(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{4451:function(e,t,o){Promise.resolve().then(o.bind(o,2577))},8925:function(e,t,o){"use strict";o.d(t,{h:function(){return n}});var a=o(8037);let n={getNFT:async(e,t,o,a)=>{let n=await e.query("yours.metadata",{project:t,collection:o,token_id:a});if(null!=n)return{token_id:a,metadata:n,blockchain:"Fishing Game",project:n.yours.project,collection:n.yours.collection}},getPudgyRods:async e=>e.query("pudgy.get_rods",{}),equipRod:async(e,t,o)=>{let n={operations:[(0,a.op)("pudgy.equip_fishing_rod",t,o),(0,a.WY6)()],signers:[]};await e.sendTransaction(n)},unequipRod:async(e,t)=>{let o={operations:[(0,a.op)("pudgy.unequip_fishing_rod",t),(0,a.WY6)()],signers:[]};await e.sendTransaction(o)},pullFish:async(e,t)=>{let o={operations:[(0,a.op)("pudgy.pull_fish",t),(0,a.WY6)()],signers:[]};await e.sendTransaction(o)}}},1229:function(e,t,o){"use strict";o.d(t,{ContextProvider:function(){return s},T:function(){return l}});var a=o(7437),n=o(2265),i=o(4984),r=o(8353);let c=(0,n.createContext)({sessions:{},setSession:()=>{},logout:async()=>{},isLoading:!0});function l(){return(0,n.useContext)(c)}function s(e){let{children:t}=e,[o,l]=(0,n.useState)({}),[s,d]=(0,n.useState)(!0),u=(0,n.useRef)({}),g=(0,n.useCallback)((e,t,o)=>{console.log("Setting session for blockchainRid: ".concat(e),t),l(o=>{if(void 0===t){let{[e]:t,...a}=o;return a}return{...o,[e]:t}}),t&&o?(u.current[e.toUpperCase()]=o,localStorage.setItem("session_".concat(e.toUpperCase()),"true")):(delete u.current[e.toUpperCase()],localStorage.removeItem("session_".concat(e.toUpperCase())))},[]),m=(0,n.useCallback)(async e=>{console.log("Handle logout for blockchainRid: ".concat(e));try{let t=u.current[e.toUpperCase()];if(t){let e=t();e instanceof Promise&&await e,console.log("Logout function executed successfully")}else console.warn("No logout function found for blockchainRid: ".concat(e));l(t=>{let{[e]:o,...a}=t;return a}),delete u.current[e.toUpperCase()],localStorage.removeItem("session_".concat(e.toUpperCase())),console.log("Session and logout function removed")}catch(e){console.error("Error during logout:",e)}},[]);return(0,n.useEffect)(()=>{(async()=>{d(!0);try{console.log("Attempting auto-login...");let e=await (0,r.Z)();if(localStorage.getItem("session_".concat(e.config.blockchainRid.toUpperCase()))){console.log("Found persisted session data, recreating session");let{session:t,logout:o}=await (0,i.e)(!0);t?(console.log("Session recreated successfully"),l({[e.config.blockchainRid.toUpperCase()]:t}),u.current[e.config.blockchainRid.toUpperCase()]=o):(console.log("Failed to recreate session, removing persisted data"),localStorage.removeItem("session_".concat(e.config.blockchainRid.toUpperCase())))}else{console.log("No persisted session found, creating new session");let{session:t,logout:o}=await (0,i.e)(!0);t?(console.log("New session created successfully"),l({[e.config.blockchainRid.toUpperCase()]:t}),u.current[e.config.blockchainRid.toUpperCase()]=o,localStorage.setItem("session_".concat(e.config.blockchainRid.toUpperCase()),"true")):console.log("Failed to create new session")}}catch(e){console.error("Failed to auto-login:",e)}finally{d(!1)}})()},[]),(0,n.useEffect)(()=>{console.log("Current sessions:",o),console.log("Logout functions available:",Object.keys(u.current))},[o]),(0,a.jsx)(c.Provider,{value:{sessions:o,setSession:g,logout:m,isLoading:s},children:t})}},2639:function(e,t,o){"use strict";var a=o(7437),n=o(6648);o(2265);var i=o(1471);let r=e=>{switch(e.toLowerCase()){case"ethereum":return"from-blue-500 via-blue-400 to-blue-300";case"mega chain":return"from-purple-600 via-purple-500 to-purple-400";case"fishing game":return"from-green-500 via-green-400 to-green-300";default:return"from-gray-500 via-gray-400 to-gray-300"}},c=e=>{switch(e.toLowerCase()){case"fishes caught":case"fishing rod":case"equipped by":case"durability":return"bg-green-500";case"recent mega chain visit":return"bg-purple-600";default:return"bg-gray-700"}};t.Z=e=>{let{imageUrl:t,tokenName:o,tokenDescription:l,metadata:s,blockchain:d,isGamePage:u=!1,actions:g=[]}=e,m=(e,t)=>(0,a.jsxs)("div",{className:"".concat(c(e.trait_type)," rounded-lg p-2 text-xs"),children:[(0,a.jsxs)("span",{className:"font-semibold",children:[e.trait_type,":"]})," ",e.value]},"".concat(e.trait_type,"-").concat(t)),h=u?s.attributes.filter(e=>["Fishes Caught","Fishing Rod"].includes(e.trait_type)):s.attributes;return(0,a.jsxs)("div",{className:"bg-[var(--color-card)] rounded-lg shadow-xl overflow-hidden transition-transform duration-300 hover:scale-105 max-w-sm mx-auto",children:[(0,a.jsx)("div",{className:"relative w-full h-64",children:(0,a.jsx)(n.default,{src:t,alt:o,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",style:{objectFit:"cover"},className:"rounded-t-lg",priority:!0})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:o}),(0,a.jsx)("div",{className:"inline-block bg-gradient-to-r ".concat(r(d)," text-white text-xs font-semibold px-2 py-1 rounded-full mb-2"),children:d}),(0,a.jsx)("p",{className:"text-gray-300 text-sm line-clamp-3 mb-4",children:l}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:h.map((e,t)=>m(e,t))})}),g.length>0&&(0,a.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:g.map((e,t)=>(0,a.jsx)("button",{onClick:e.onClick,className:"mega-button text-sm relative",disabled:e.loading,children:e.loading?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"opacity-0",children:e.label}),(0,a.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)(i.Z,{size:"medium"})})]}):e.label},t))})]})]})}},1471:function(e,t,o){"use strict";var a=o(7437);o(2265),t.Z=e=>{let{size:t="medium"}=e,o={small:"border-[1px]",medium:"border-2",large:"border-3"},n={small:"inset-[2px]",medium:"inset-1",large:"inset-1.5"};return(0,a.jsxs)("div",{className:"".concat({small:"h-4 w-4",medium:"h-8 w-8",large:"h-12 w-12"}[t]," relative"),children:[(0,a.jsx)("div",{className:"absolute inset-0 rounded-full animate-spin-slow ".concat(o[t]," border-transparent"),children:(0,a.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-full ".concat({small:"blur-[1px]",medium:"blur-[2px]",large:"blur-[3px]"}[t]," opacity-75")})}),(0,a.jsx)("div",{className:"absolute ".concat(n[t]," bg-[var(--color-background)] rounded-full")}),(0,a.jsx)("div",{className:"absolute ".concat(n[t]," rounded-full animate-spin ").concat(o[t]," border-transparent"),children:(0,a.jsx)("div",{className:"h-full w-full bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 rounded-full"})})]})}},2577:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return F}});var a=o(7437),n=o(2265),i=o(6463),r=o(2639),c=o(1471),l=o(8037);let s={getNFT:async(e,t,o,a)=>{var n,i;let r=await e.query("yours.metadata",{project:t,collection:o,token_id:a});return{token_id:a,metadata:r,blockchain:"Mega Chain",project:(null===(n=r.yours)||void 0===n?void 0:n.project)||"MISSING",collection:(null===(i=r.yours)||void 0===i?void 0:i.collection)||"MISSING"}},getNFTs:async e=>(await e.query("importer.get_tokens")).map(e=>{var t,o;return{...e,blockchain:"Mega Chain",project:(null===(t=e.metadata.yours)||void 0===t?void 0:t.project)||"MISSING",collection:(null===(o=e.metadata.yours)||void 0===o?void 0:o.collection)||"MISSING"}}),importNFT:async(e,t,o,a,n)=>{await e.call((0,l.op)("importer.import_token",[n.name,n.attributes.map(e=>[e.trait_type,e.value]),[[],t,o],n.description,n.image,null],a))}},d={getGatewayUrl:e=>{let t="ipfs://";if(e.startsWith(t)){let o=e.slice(t.length);return"https://ipfs.io/ipfs/".concat(o)}return e},fetchNFTMetadata:async e=>{let t=await fetch(d.getGatewayUrl(e)),o=await t.json();return{image:d.getGatewayUrl(o.image),name:o.name,description:o.description,attributes:o.attributes}}},u="TheIglooCompany",g=[8109,8110,8111,8112,8113,8114],m=[1447,8400,706,8225,3525,6610],h={getNFTs:async()=>[...await Promise.all(g.map(async e=>{let t=await d.fetchNFTMetadata("".concat("ipfs://bafybeibc5sgo2plmjkq2tzmhrn54bk3crhnc23zd2msg4ea7a4pxrkgfna","/").concat(e));return{token_id:e,metadata:t,blockchain:"Ethereum",project:u,collection:"Pudgy Penguins"}})),...await Promise.all(m.map(async e=>{let t=await d.fetchNFTMetadata("".concat("https://api.pudgypenguins.io/present","/").concat(e)),o={...t,attributes:[t.attributes]};return console.log("fixedMetadata",o),{token_id:e,metadata:o,blockchain:"Ethereum",project:u,collection:"Pudgy Rods"}}))]};var p=o(1229),f=o(9659);let b={};async function y(e){let t;if(b[e])return b[e];let o=await (0,f.eI)({directoryNodeUrlPool:["https://node0.devnet1.chromia.dev:7740"],blockchainRid:e}),a=await (0,l.nxA)(window.ethereum),n=(0,l._zT)(o,a),i=await n.getAccounts(),r=i[0];if(i.length>0){let{session:e}=await n.login({accountId:r.id,config:{rules:(0,l.mm6)((0,l.i4F)(1)),flags:["MySession"]}});t=e}else{let e=(0,l.Wh)(["A","T"],a.id),{session:n}=await (0,l.UDE)(o,a,l.SCz.open(e,{config:{rules:(0,l.mm6)((0,l.i4F)(1)),flags:["MySession"]}}));t=n}return b[e]=t,t}async function w(e,t,o,a,n){if(!e)return;let i=await y(n),r=await e.query("yours.metadata",{project:t,collection:o,token_id:a});console.log("Metadata: ".concat(r)),await e.transactionBuilder().add((0,l.op)("yours.init_transfer",e.account.id,t,o,a,1,r),{onAnchoredHandler:async e=>{if(!e)throw Error("No data provided");let t=await e.createProof(i.blockchainRid);await i.transactionBuilder().add(t,{authenticator:l.wSQ}).add((0,l.op)("yours.apply_transfer",e.tx,e.opIndex),{authenticator:l.wSQ}).buildAndSend()}}).buildAndSendWithAnchoring()}async function x(e,t,o,a,n){if(!e)return;let i=await y(n),r=await i.query("yours.metadata",{project:t,collection:o,token_id:a});await i.transactionBuilder().add((0,l.op)("yours.init_transfer",i.account.id,t,o,a,1,r),{onAnchoredHandler:async t=>{if(!t)throw Error("No data provided");let o=await t.createProof(e.blockchainRid);await e.transactionBuilder().add(o,{authenticator:l.wSQ}).add((0,l.op)("yours.apply_transfer",t.tx,t.opIndex),{authenticator:l.wSQ}).buildAndSend()}}).buildAndSendWithAnchoring()}var k=o(8925),v=o(2755),N=e=>{let{isOpen:t,onClose:o,children:n}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,a.jsxs)("div",{className:"modal-content bg-gradient-to-br from-[var(--color-surface)] to-[var(--color-background)] rounded-lg p-6 max-w-sm w-full border border-[var(--color-primary)] shadow-lg",children:[(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{onClick:o,className:"text-[var(--color-text)] hover:text-[var(--color-primary)] transition-colors duration-300",children:"\xd7"})}),n]})}):null},j=o(8353),F=function(){let[e,t]=(0,n.useState)([]),[o,l]=(0,n.useState)(!0),[d,u]=(0,n.useState)({}),{sessions:g}=(0,p.T)(),[m,f]=(0,n.useState)(),b=(0,i.useRouter)(),[y,F]=(0,n.useState)(null),[_,C]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{f(g[(await (0,j.Z)()).config.blockchainRid.toUpperCase()])})()},[g]),(0,n.useEffect)(()=>{m&&S()},[m]);let S=async()=>{if(m){l(!0);try{let e=await h.getNFTs(),o=await s.getNFTs(m),a=await (0,v.Z)();console.log("External NFTs: ".concat(JSON.stringify(e))),console.log("Mega Yours NFTs: ".concat(JSON.stringify(o)));let n=[];for(let t of(n.push(...e),o)){let e=n.findIndex(e=>e.token_id===t.token_id);-1!==e?n[e]={metadata:t.metadata,blockchain:t.blockchain,token_id:t.token_id,project:t.project,collection:t.collection}:n.push(t)}for(let e of o){let t=await k.h.getNFT(a,e.project,e.collection,e.token_id);if(console.log("Fishing Game NFT: ".concat(JSON.stringify(t))),t){let o=n.findIndex(t=>t.token_id===e.token_id);-1!==o&&(console.log("Updating NFT as Fishing one"),n[o]={metadata:t.metadata,blockchain:t.blockchain,token_id:e.token_id,project:e.project,collection:e.collection})}}t(n)}catch(e){console.error("Error fetching NFTs:",e)}finally{l(!1)}}},E=e=>{t(t=>t.map(t=>t.token_id===e.token_id?e:t))},T=(e,t,o)=>{u(a=>({...a,["".concat(e,"-").concat(t)]:o}))},I=async(e,t,o,a)=>{if(m){T(o,"import",!0);try{await s.importNFT(m,e,t,o,a);let n=await s.getNFT(m,e,t,o);n?E(n):console.error("Failed to fetch updated NFT data after import")}catch(e){console.error("Error importing token:",e)}finally{T(o,"import",!1)}}},U=async(e,t,o)=>{if(m){T(o,"bridgeToFishing",!0);try{let a=await (0,v.Z)();await w(m,e,t,o,a.config.blockchainRid),await new Promise(e=>setTimeout(e,5e3));let n=await k.h.getNFT(a,e,t,o);n&&E({...n,token_id:o,collection:t})}catch(e){console.error("Error bridging token to Fishing Game:",e)}finally{T(o,"bridgeToFishing",!1)}}},M=async(e,t,o)=>{if(m){T(o,"bridgeFromFishing",!0);try{let a=await (0,v.Z)();await x(m,e,t,o,a.config.blockchainRid),await new Promise(e=>setTimeout(e,5e3));let n=await s.getNFT(m,e,t,o);n&&E(n)}catch(e){console.error("Error bridging token from Fishing Game:",e)}finally{T(o,"bridgeFromFishing",!1)}}},R=async e=>{b.push("/game?project=".concat(e.project,"&collection=").concat(e.collection,"&tokenId=").concat(e.token_id))},P=e=>{F(e),C(!0)},A=()=>{C(!1),F(null)},G=async e=>{if(y){A(),T(y.token_id,"bridge",!0);try{"Ethereum"===y.blockchain&&"Mega Chain"===e?await I(y.project,y.collection,y.token_id,y.metadata):"Mega Chain"===y.blockchain&&"Fishing Game"===e?await U(y.project,y.collection,y.token_id):"Fishing Game"===y.blockchain&&"Mega Chain"===e&&await M(y.project,y.collection,y.token_id)}catch(e){console.error("Error bridging token:",e)}finally{T(y.token_id,"bridge",!1)}}},B=e=>{let t=[];return t.push({label:"Bridge",onClick:()=>P(e),loading:d["".concat(e.token_id,"-bridge")]||!1}),"Fishing Game"===e.blockchain&&"Pudgy Penguins"===e.collection&&t.push({label:"Play",onClick:()=>R(e),loading:!1}),t};return o?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8 flex justify-center items-center h-screen",children:(0,a.jsx)(c.Z,{size:"large"})}):(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.filter(e=>{var t;return null==e?void 0:null===(t=e.metadata)||void 0===t?void 0:t.image}).map((e,t)=>(0,a.jsx)(r.Z,{imageUrl:e.metadata.image||"",tokenName:e.metadata.name,tokenDescription:e.metadata.description,metadata:e.metadata,actions:B(e),blockchain:e.blockchain},"".concat(e.token_id,"-").concat(e.blockchain)))}),(0,a.jsx)(N,{isOpen:_,onClose:A,children:y&&(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Select a target blockchain"}),(0,a.jsxs)("div",{className:"space-y-2",children:["Ethereum"===y.blockchain&&(0,a.jsx)("button",{className:"w-full bg-blue-500 text-white py-2 px-4 rounded",onClick:()=>G("Mega Chain"),children:"Mega Chain"}),"Mega Chain"===y.blockchain&&(0,a.jsx)("button",{className:"w-full bg-green-500 text-white py-2 px-4 rounded",onClick:()=>G("Fishing Game"),children:"Fishing Game"}),"Fishing Game"===y.blockchain&&(0,a.jsx)("button",{className:"w-full bg-purple-500 text-white py-2 px-4 rounded",onClick:()=>G("Mega Chain"),children:"Mega Chain"})]})]})})]})}},4984:function(e,t,o){"use strict";o.d(t,{e:function(){return i}});var a=o(8037),n=o(8353);async function i(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!window.ethereum)return console.error("Ethereum not found on window"),{session:void 0,logout:()=>{}};let t=await (0,n.Z)(),o=await (0,a.nxA)(window.ethereum),i=(0,a._zT)(t,o),r=await i.getAccounts(),c=(0,a.U7w)();if(r.length>0){let t=r[0].id;if(e){let e=await c.getKeyStore(t);if(!(null==e?void 0:e.pubKey))return{session:void 0,logout:()=>{}};{let{session:e,logout:o}=await i.login({accountId:t,loginKeyStore:c,config:{rules:(0,a.mm6)((0,a.i4F)(2)),flags:["MySession"]}});return{session:e,logout:()=>{o(),console.log("Logging out...")}}}}let{session:o,logout:n}=await i.login({accountId:t,loginKeyStore:c,config:{rules:(0,a.mm6)((0,a.i4F)(2)),flags:["MySession"]}});return{session:o,logout:()=>{n(),console.log("Logging out...")}}}if(!e){let e=(0,a.Wh)(["A","T"],o.id),{session:n,logout:i}=await (0,a.UDE)(t,o,a.SCz.open(e,{config:{rules:(0,a.mm6)((0,a.i4F)(2)),flags:["MySession"]}}));return{session:n,logout:()=>{i(),console.log("Logging out...")}}}return{session:void 0,logout:()=>{}}}},2755:function(e,t,o){"use strict";let a;var n=o(9659);let i="2CD6F1B889AC56E735BE2B82F6F2021804F356C581725E392EECCC85D50F449B";async function r(){if(a)return a;let e={directoryNodeUrlPool:"https://node0.devnet1.chromia.dev:7740"};return i?e.blockchainRid=i:e.blockchainIid=2,a=await (0,n.eI)(e)}t.Z=r},8353:function(e,t,o){"use strict";let a;var n=o(9659);let i="https://node0.devnet1.chromia.dev:7740",r="1DF67D3EBCD16D012BE3A8F591B778F3ECE35E122389E155838CF814A473063E";async function c(){if(console.log("Getting Mega Yours Chromia Client"),console.log("NODE_URL_POOL",i),console.log("BLOCKCHAIN_RID",r),a)return a;let e={directoryNodeUrlPool:i};return r?e.blockchainRid=r:e.blockchainIid=1,a=await (0,n.eI)(e)}t.Z=c}},function(e){e.O(0,[999,233,595,971,23,744],function(){return e(e.s=4451)}),_N_E=e.O()}]);